# PhishSenseDashboard 현재 현황 정리

## 1. 진행 과정(커밋 로그 기준, 시간 순)
1. (9fd8a00) 초기 커밋 - 저장소 기본 골격을 생성했다.
2. (903737d) 피싱 시뮬레이션 플랫폼 대시보드와 내비게이션의 기본 구조를 세팅했다.
3. (8020434) 프로젝트·템플릿·훈련 페이지의 통합 관리 기능을 추가했다.
4. (613bb42) 프로젝트 관리 개선과 훈련 대상 소속 확장을 반영했다.
5. (de7b79c) 프로젝트 관리 기능을 추가로 개선했다.
6. (3296265) 비교용 프로젝트 생성 흐름을 추가했다.
7. (feb4caa) 레이어드 구조와 분기별 프로젝트 관리 기능을 구성했다.
8. (d3906af) 프로젝트 생성 페이지를 개선했다.
9. (65efb77) 훈련 대상자 생성 페이지의 조직 추가 기능과 스크롤 동작을 수정했다.
10. (eed648c) 템플릿 수정 페이지를 변경하고 테스트 메일 SMTP 연결을 반영했다.
11. (aadee1a) SMTP 관리 페이지 화면을 만들고 API 개발을 진행 중으로 반영했다.
12. (52d3f76) SMTP 관리 화면 개발을 완료하고 API 수정 진행 상태를 반영했다.
13. (8829bdf) SMTP API 수정 완료와 훈련 대상 업로드 개발 완료를 반영했다.
14. (57bcf40) Next.js와 PostgreSQL로 전환을 완료했다.
15. (b1bca20) 프로젝트 훈련 안내 링크 토큰과 공개 라우트를 추가했다.
16. (365a0bd) 훈련 대상 업로드 데이터를 DB에 저장하도록 전환했다.
17. (85b1cb2) 테스트 발송 시 SMTP 오류 진단 정보를 보강했다.
18. (7dc233d) 훈련 페이지 미리보기 HTML 정리와 폰트 경로를 수정했다.
19. (46b78d2) 하이드레이션 오류 완화를 위해 클라이언트 전용 렌더링을 적용했다.
20. (04443df) 개발 환경에서 테스트 발송 오류 메시지를 노출했다.
21. (2fa9ebd) 테스트 메일 발송에서 465 실패 시 587로 재시도하도록 했다.
22. (711d76c) 훈련 안내 링크가 템플릿 버튼에 적용되도록 수정했다.
23. (7e35d59) 테스트 발송 임시 저장과 임시 상태 표시를 추가했다.
24. (3e6a5a7) 메일 링크를 악성 본문으로 연결하고 안내 링크를 추가했다.
25. (d56b829) 악성 본문 라우트의 빌드 오류를 수정했다.
26. (1d05e59) 훈련 안내 링크 이동 방식을 버튼 이동으로 변경했다.
27. (f157ef5) 훈련 안내 접근을 악성 링크 경유로 제한했다.
28. (5545857) 악성 본문 링크를 기존 a 또는 button에 자동 지정하도록 했다.
29. (29de556) SMTP 테스트 수신 도메인 허용 범위를 확장했다.
30. (3d80522) SMTP 테스트 발송에서 발신자를 계정으로 고정했다.
31. (e45720e) SMTP 테스트 오류 표시와 실행 조건을 정리했다.
32. (b26642f) SMTP 테스트 블록에서 저장 후 테스트 버튼을 제거했다.
33. (b9f1851) SMTP 설정 삭제 기능을 추가했다.
34. (c6ee0c1) SMTP 설정 상세 화면의 상태 훅 누락을 수정했다.
35. (edfd223) SMTP 테스트 메일 제목·본문 입력을 지원했다.
36. (a333134) 삭제 버튼 스타일을 통일했다.
37. (7fc2fcb) SMTP 테스트 메일 내용 입력 폼을 분리했다.
38. (85a287c) SMTP 테스트 발송 입력값 전달 오류를 수정했다.
39. (eb62b32) SMTP 관리 삭제 버튼 스타일을 통일했다.
40. (b59b5f8) SMTP 설정 목록에 도메인 컬럼을 추가했다.
41. (f372368) SMTP 테스트 메일 내용 입력 블록을 제거했다.
42. (9dac58e) SMTP 도메인 안내 문구를 제거했다.
43. (34a113e) 프로젝트 생성 버튼 문구를 변경했다.
44. (d06c279) 프로젝트 발신 도메인에 SMTP 표시를 추가했다.
45. (52ffed2) 프로젝트 발신 도메인을 SMTP 목록과 연동했다.
46. (379346a) 프로젝트 발신 도메인 옵션 누락을 보완했다.
47. (d7bb319) 발신 도메인 SMTP 문구를 정리했다.
48. (5002a32) 발신 도메인 중복 제거와 보안 모드 표시를 반영했다.
49. (612afcd) SMTP 중복 도메인 및 설정 등록을 방지했다.
50. (8a8befb) SMTP 상태 토글을 추가했다.
51. (a732d42) 프로젝트·훈련안내 데이터를 DB 저장 방식으로 전환했다.
52. (e2595ea) 프로젝트·훈련안내 기본 데이터 시드를 추가했다.
53. (55855d9) 프로젝트 시드 데이터를 월별 3개로 조정했다.
54. (cd8e7e6) 프로젝트 월별 시드를 2~5개로 랜덤 구성했다.
55. (dc809d9) 프로젝트 시드 랜덤화와 기본 시드 재시도 처리를 추가했다.
56. (cd90109) 전직원 대상 훈련 선택 시 초기화 방지를 반영했다.
57. (3e198bd) 예약 프로젝트 자동 시작과 즉시 시작 버튼을 추가했다.
58. (96bcbef) 전직원 대상 선택 시 충돌 경고 레이아웃을 조정했다.
59. (34b9e6e) 예약 프로젝트 상세에 지금 시작 버튼을 추가했다.
60. (2f6af5e) 프로젝트 생성 대상 선택 시 우측 여백을 제거했다.
61. (8eca0b6) 중복 충돌 경고를 모달로 표시했다.
62. (dda3773) 예약 생성 시 시작일 검증을 추가했다.
63. (5b1cb04) 프로젝트 관리 예약 항목의 즉시 시작 버튼을 제거했다.
64. (80ef92c) 템플릿 기본 시딩을 환경과 데이터 상태에 따라 제한했다.
65. (a51d522) 주요 관리 화면의 부가 설명을 제거했다.
66. (ce72146) 프로젝트 관리 힌트 문구를 예시 중심으로 변경했다.
67. (c427bcd) 프로젝트 관리 일괄 액션을 비교·삭제 중심으로 변경했다.
68. (e24a466) 프로젝트 관리 일괄 액션 버튼 구성을 정리했다.
69. (8cb67b4) 템플릿 편집 에디터 모드 전환 위치를 조정했다.
70. (db37d8d) 훈련 대상 관리 타입 참조 오류를 수정했다.

## 2. 현재 라이브러리 구조
### 프런트엔드
- Next.js(앱 라우터 기반)와 React 18을 중심으로 화면과 API 라우트를 구성한다.
- Tailwind CSS + tailwindcss-animate + tailwind-merge로 유틸리티 기반 스타일링을 적용한다.
- Radix UI 컴포넌트 세트로 접근성 중심의 UI 베이스를 제공한다.
- @tanstack/react-query로 데이터 패칭/캐싱을 관리한다.
- react-hook-form + zod/@hookform/resolvers로 폼 입력 검증과 타입 안전성을 확보한다.
- @toast-ui/react-editor로 템플릿/훈련 콘텐츠 편집을 지원한다.
- recharts, framer-motion, embla-carousel-react, lucide-react로 데이터 시각화·애니메이션·아이콘을 보강한다.

### 백엔드/서버 기능
- drizzle-orm + pg로 PostgreSQL 연동을 담당한다.
- drizzle-zod로 스키마 기반 검증 모델을 생성한다.
- nodemailer로 SMTP 테스트 발송과 메일 전송 기능을 제공한다.
- sanitize-html로 템플릿 및 악성 본문 HTML을 정제한다.
- dotenv로 환경 변수 로딩을 지원한다.

### 개발 도구
- TypeScript, Vitest, Drizzle Kit, PostCSS, TailwindCSS를 빌드/테스트/스타일링 파이프라인으로 사용한다.

## 3. 현재 파일/디렉터리 구조 요약
### 상위 구조
- `src/app`: Next.js 앱 라우터 페이지 및 API 라우트.
- `src/features`: 화면 단위 기능 구성(대시보드, 프로젝트, 템플릿, 훈련 페이지 등).
- `src/components`: 공용 UI 컴포넌트와 레이아웃 구성.
- `src/hooks`: 커스텀 훅 모음.
- `src/lib`: API 호출, 에디터/보안 유틸, 쿼리 클라이언트 등 공통 유틸.
- `src/server`: DAO, 서비스, 시드, 유틸 등 서버 로직 모듈.
- `shared`: Drizzle 스키마와 공용 타입.
- `docs`: 문서 모음.
- `attached_assets`: 참고용 자산.
- `scripts`: 보조 스크립트.
- `dist`: 빌드 산출물(과거/참고 용도로 존재).
- `dev.db`: 로컬 개발 DB 파일.
- 구성 파일: `next.config.mjs`, `tsconfig.json`, `tailwind.config.ts`, `postcss.config.js`, `drizzle.config.ts` 등.

### 주요 라우트(Next 앱 라우터)
- `src/app/projects`, `src/app/templates`, `src/app/targets`, `src/app/training-pages`: 관리 화면 라우트.
- `src/app/admin/smtp`: SMTP 관리 라우트.
- `src/app/p/[token]`, `src/app/t/[token]`: 토큰 기반 훈련/안내 라우트.
- `src/app/api/**`: 프로젝트/템플릿/대상/훈련/업로드/SMTP 관리 API 라우트.

### 서버 모듈 구성
- `src/server/dao`: 프로젝트/템플릿/훈련 페이지/대상/SMTP 관련 DB 접근 레이어.
- `src/server/services`: 프로젝트 공유 로직, SMTP 관리 서비스 등.
- `src/server/seed`: 기본 템플릿 및 시드 데이터.
- `src/server/lib`: SMTP, SSRF 방어, 링크 토큰, 검증 유틸.
- `src/server/utils`: HTML 정제, 암호화 유틸 및 테스트.
- `src/server/storage.ts`: 메모리 스토리지와 일부 DB 연동 브리지.

### 특이사항
- `*:Zone.Identifier` 파일은 Windows 다운로드 메타데이터로 보이며, 실제 소스 파일이 존재하지 않는 경우가 있어 정리가 필요하다.

## 4. 사용 언어와 활용 방식
- TypeScript: 프런트/서버 공통으로 사용하며, 프로젝트·템플릿·대상·훈련 페이지 등 핵심 도메인 모델을 타입으로 고정해 안정적인 개발을 지원한다.
- TSX/JSX: 대시보드/관리 화면 등 UI 렌더링에 활용하며, 컴포넌트 재사용과 상태 관리에 강점이 있다.
- SQL(PostgreSQL): SMTP 계정·템플릿 등 영속 데이터 저장에 활용한다.
- HTML: 메일 템플릿 본문과 악성 본문, 훈련 페이지 콘텐츠를 구성한다.
- CSS(Tailwind): 관리자 콘솔의 빠른 UI 스타일링과 일관된 디자인 토큰 적용에 사용한다.
- JSON/ENV: 설정(`package.json`), 시드 데이터, 환경 변수 관리에 사용한다.

## 5. 장점과 향후 발전 방향
- 타입 공유 구조는 프런트와 서버 간 계약을 명확히 하므로, 기능 확장 시 안정적인 유지보수를 지원한다.
- Next.js 기반 앱 라우터와 API 라우트는 관리 콘솔과 API를 단일 코드베이스에서 운영할 수 있어 배포·운영 효율을 높인다.
- Drizzle + Zod 조합은 스키마 기반 검증을 강화할 수 있어 규정된 데이터 품질을 확보하기 좋다.
- SMTP/템플릿 관리가 이미 모듈화되어 있어 향후 멀티 테넌트, 전송 정책, 발송 로그/감사 추적 확장이 수월하다.
- 향후 발전 제안:
  - 프로젝트/훈련 대상/훈련 페이지까지 DB 영속화 범위를 확대해 운영 신뢰성을 높인다.
  - 예약 발송, 대량 발송을 위해 큐(BullMQ 등) 및 백그라운드 워커를 추가한다.
  - 클릭/열람/제출 이벤트를 더 정교하게 수집해 리포팅 대시보드(시계열·부서별 비교)를 고도화한다.
  - 보안 관점에서 입력 정제 범위를 확대하고, 발송 도메인/링크 검증 규칙을 체계화한다.
  - 테스트 범위를 API 통합 테스트와 시나리오 테스트까지 확대해 회귀 위험을 줄인다.
